{% extends 'article.html' %}
{% block coral %}
<div id="coral_thread"></div>
<script src="{{pageRootUrl}}/assets/client.js"></script>
<script data-cfasync="false"
    src="https://www.opendemocracy.net/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script>
<script type="text/javascript">
    (function () {
        var d = document, s = d.createElement('script');
        s.src = '{{coralRootUrl}}/assets/js/embed.js';
        s.async = false;
        s.defer = true;
        s.onload = function () {
            Coral.createStreamEmbed({
                events: function (events) {
                    events.onAny(function (eventName, data) {
                        console.log(eventName, data);
                        if (gfwPanelVisible) {
                            gfwUpdateContents({
                                output: eventName + ' ' + JSON.stringify(data)
                            })
                        }

                        if (eventName === 'signedIn' && gfwCommentsActive) {
                            gfwGotSignedInUser();
                        }

                        if (eventName === 'createComment.success') {
                            //my_event_tracker.send('createComment', data);
                        }
                    });
                },
                id: "coral_thread",
                autoRender: true,
                rootURL: '{{coralRootUrl}}',
                // Uncomment these lines and replace with the ID of the
                // story's ID and URL from your CMS to provide the
                // tightest integration. Refer to our documentation at
                // https://docs.coralproject.net for all the configuration
                // options.
                storyID: '{{pageSlugHash}}',
                storyURL: '{{ pageFullUrl }}',
            });
        };
        (d.head || d.body).appendChild(s);
    })();
</script>
{% endblock %}